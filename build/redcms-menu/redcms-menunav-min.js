YUI.add("redcms-menunav",function(c){var b,a="contentBox";b=c.Base.create("redcmsnavmenu",c.Widget,[c.RedCMS.RedCMSWidget],{_lastOpenedMenuNode:null,_menuNode:null,_sortable:null,_syncEmptyNodes:function(){this._menuNode.all("ul").each(function(e){var d=e.get("children");if(d.size()===0){e.append('<li class="yui3-menuitem yui3-menuitem-empty"><a class="yui3-menuitem-content" ><em>No item in this category.</em></a></li>');}else{if(d.size()==2){d.each(function(f){if(f.hasClass("yui3-menuitem-empty")){f.remove();}});}}});},renderUI:function(){this._menuNode=this.get(a).one(".yui3-menu");this._menuNode.all(".yui3-menu").each(function(d){d.append('<div class="yui3-menu-shadow"></div>');});this._menuNode.plug(c.Plugin.NodeMenuNav,{mouseOutHideDelay:200000,submenuHideDelay:200000});this._menuNode.removeClass("redcms-hidden");this._syncEmptyNodes();},bindUI:function(){var d=this.get(a);if(!d.hasClass("yui3-redcms-canwrite")){return;}c.use("sortable",c.bind(function(e){var f=new e.Sortable({container:d.one("ul"),nodes:"li",handles:["a"],opacity:"0.4"});f.delegate.dd.removeInvalid("a");f.delegate.on("drag:mouseDown",function(g){if(!g.target.get("node").hasAttribute("redid")){g.preventDefault();g.ev.halt();}});f.delegate.on("drag:start",function(h){var g=h.target.get("dragNode");g.setStyles({"z-index":999,"opacity":"0.7"});g.all(".yui3-menu").addClass("yui3-menu-hidden");});f.delegate.on("drop:over",function(k){var h=k.drag.get("node"),g=k.drop.get("node"),j=g.one(".yui3-menu"),i;if(j&&h!=g){if(this._lastOpenedMenuNode&&!this._lastOpenedMenuNode.contains(j)){this._menuNode.menuNav._hideMenu(this._lastOpenedMenuNode);}this._menuNode.menuNav._showMenu(j);this._lastOpenedMenuNode=j;i=j.one("li");this._menuNode.menuNav._focusItem(i);this._menuNode.menuNav._setActiveItem(i);}this._syncEmptyNodes();e.DD.DDM.syncActiveShims(true);},this);f.delegate.on("drag:end",function(j){var h=j.target.get("node"),g=h.ancestor("[redid]"),i=h.previous("[redid]"),k={id:h.getAttribute("redid"),parentId:g.getAttribute("redid"),redaction:"submit"};if(i){k.targetId=i.getAttribute("redid");}e.io(e.RedCMS.RedCMSManager.getLink("PositionManager"),{data:k,on:{success:function(n,m,l){}},context:this});this._syncEmptyNodes();},this);this._sortable=f;},this));},destructor:function(){this._menuNode.unplug(c.Plugin.NodeMenuNav);this._sortable.destroy();}},{});c.namespace("RedCMS").MenuNav=b;},"@VERSION@",{requires:["node-menunav","widget-position","sortable","redcms-base"]});